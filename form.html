<!DOCTYPE html>
<html>
<head>
<title>form</title>
<meta charset="UTF-8">
<link rel="stylesheet" type="text/css" href="./styles/common.css" media = "screen" />
<link rel="stylesheet" type="text/css" href="./styles/left_nav.css" media = "screen" />
<script src="https://cdn.firebase.com/js/client/2.2.7/firebase.js"></script>
<script>
    var dataRef = new Firebase("https://html5-cyff.firebaseio.com/data"); // create data base reference at loading time
</script>
<style>

#usage_text {overflow-x: scroll }
#example_text {overflow-x: scroll}
#default_css_text {overflow-x: scroll}

#attr_list           {}
#attr_list  tr > td:nth-child(1) {width: 15%}
#attr_list  tr > td:nth-child(2) {width: 15%}
#attr_list  tr > td:nth-child(3) {width: 70%}

#browser_sup_list    {}
#browser_sup_list  tr > td:first-child  {width: 150px; font-size: 16px}
#browser_sup_list  tr > td:nth-child(2) {width: 120px}
#browser_sup_list  tr > td:nth-child(3) {width: 120px}
#browser_sup_list  tr > td:nth-child(4) {width: 120px}
#browser_sup_list  tr > td:nth-child(5) {width: 120px}
#browser_sup_list  tr > td:nth-child(6) {width: 120px}

</style>
</head>

<body id = "whole_page">

<div id = "logo">
	<div id = "nav_bar">
		<table class = "container_tb" id = "nav_bar_container" >
			<tr>
				<td>
					<div id='nav_menu'>
						<ul>
							<li><a class='active' href='./index.html'><span>Home</span></a></li>
							<li><a href='./tutorial.html'><span>HTML Tutorial</span></a></li>
							<li><a href='./reference_main.html'><span>References</span></a></li>
							<li><a href='./site_map.html'><span>Site Map</span></a></li>
							<li><a href='./about_us.html'><span>About Us</span></a></li>
						</ul>
					</div>
				</td>
				<td>
					<form action = "./form.html">
						<input id = "nav_search_box"    type = "text" value = " Search here ...">
					</form>
				</td>
			</tr>
		</table>
	</div>
	<h2>CYFF</h2>
	<h1 style = "text-align:center">HTML Guide</h1>
	<br>
</div>

<table id = "nav_main_container" class = "container_tb">
<tr>
<td id = "left">
	<div id='cssmenu'>
	<ul>
		<li><a  href='./index.html'><span>Home</span></a></li>
		<li><a href='./tutorial.html'><span>Tutorials</span></a></li>
		<li class='active has-sub'><a href='reference_main.html'><span>References</span></a>
			<ul>
				<li><a href='./reference_nav.html?category_name=structure_tags'><span>Structure Tags</span></a></li>
				<li><a href='./reference_nav.html?category_name=meta_information_tags'><span>Meta Information Tags</span></a></li>
				<li><a href='./reference_nav.html?category_name=text_tags'><span>Text Tags</span></a></li>
				<li><a href='./reference_nav.html?category_name=links'><span>Links</span></a></li>
				<li><a href='./reference_nav.html?category_name=image_and_object_tags'><span>Image and Object Tags</span></a></li>
				<li><a href='./reference_nav.html?category_name=list_table_and_form_tags'><span>List, Table and Form Tags</span></a></li>
				<li><a href='./reference_nav.html?category_name=scripts'><span>Scripts</span></a></li>
			</ul>
		</li>
		<li><a href='./site_map.html'><span>Site Map</span></a></li>
		<li><a href='./about_us.html'><span>About Us</span></a></li>
	</ul>
	</div>
</td>

<td id = "right">

<div id = "navigation_links">
	<a href = "./index.html">Home>></a> 
	<a href = "./reference_main.html">Reference>></a> 
	<a href = "#" id = "last_level_link"></a>    <!--These two links will be rendered at loading time--> 
	<a href = "#" id = "curr_level_link"></a>
	<h1 style = "text-align:center" id = "page_title"></h1>           <!--The title of this pahe will be rendered at loading time-->
	<hr style = "width: 750px" >
</div>

<div id = "main_content">

	<section id = "definition">
		<h2>Definition</h2>
		<div class = "text_block" id = "def_text"></div>
    </section>
  
    <section id = "usage">
		<h2>Usage</h2>
		<div class = "text_block" id = "usage_text"></div>
    </section>
  
    <section id = "specification_of_attribuyes">
		<h2>Specification of Attributes</h2>
		<div class = "table_block" > 
			<table class = "content_table" id = "attr_list">
				<tr>
					<td class = "stext"><b> Attribute </b></td>
					<td class = "stext"><b> Value </b></td>
					<td class = "stext"><b> Specification </b></td>
				</tr>	
			</table>
		</div>
	</section>
  
	<section id = "exmple">
		<h2>Example</h2>
		<div class = "text_block" id = "example_text"></div>
    </section>
  
	<section id = "browser_support">
		<h2>Browser Support</h2>
		<div class = "table_block"> 
			<table class = "content_table" id = "browser_sup_list">
				<tr>
					<td class = "stext">Element</td>
					<td class = "stext"><img src = "./images/chrome.jpg"  height = "70" width = "70" alt = "Image is missing"></td>
					<td class = "stext"><img src = "./images/safari.jpg"  height = "70" width = "70" alt = "Image is missing"></td>
					<td class = "stext"><img src = "./images/firefox.jpg" height = "70" width = "70" alt = "Image is missing"></td>
					<td class = "stext"><img src = "./images/IE.jpg"      height = "70" width = "70" alt = "Image is missing"></td>
					<td class = "stext"><img src = "./images/opera.jpg"   height = "70" width = "70" alt = "Image is missing"></td>                
				</tr>
				<!-- This is an example of second row:
				<tr>
					<td class = "stext">&lt;form&gt;</td>
					<td class = "stext">Yes</td>
					<td class = "stext">Yes</td>
					<td class = "stext">Yes</td>
					<td class = "stext">Yes</td>
					<td class = "stext">Yes</td>
				</tr>
				-->
			</table>
		</div>
    </section>
  
	<section id = "default_css">
		<h2>Default CSS</h2>
		<div class = "text_block", id = "default_css_text"></div>
	</section>

</div>

<div id = "footer">
<footer>
<hr>
<p>Copy Right 2015, Team CYFF, All Rights Reserved</p>
</footer>
</div>

</td>
</tr>
</table>

<script>
function parseValue(key){
    var start = document.URL.search(key);

    start = start + key.length + 1; 
    var end = start;
    for ( ; end < document.URL.length; end ++ )
    {
        if (document.URL[end] == '&') break;
    } 
    return document.URL.slice(start, end);
}

function generateTitleAndNavigationLink (snapshot){
	var category_name = snapshot.child('category').val(); // get category name
	var tag_name = snapshot.key();  // get tag name

	last_level_link_ele = document.getElementById('last_level_link');
	last_level_link_ele.innerHTML = category_name.replace(/_/g, ' ') + ">>";
	last_level_link_ele.setAttribute('href', './reference_nav.html?category_name=' + category_name);

	curr_level_link_ele = document.getElementById('curr_level_link');
	curr_level_link_ele.innerHTML = tag_name + ">>";

	page_title = document.getElementById('page_title');
	page_title.innerHTML = "&lt;" + tag_name + "&gt;";
}

function generateDefinition (snapshot){
	document.getElementById('def_text').innerHTML = (snapshot.val())['definition'];
}

function generateUsage (snapshot) {
	var usage = snapshot.child('usage');
	var text = '';
	
	//combine usage text 
	usage.forEach (function (line){
		text = text + line.val() + "\n";
	});

	var container = document.getElementById('usage_text')

	if (container){
		container.innerHTML = '<pre>' + text + '<pre>';
	}else{
		alert("RENDER ERROR: can not write \"Usage\"");
	}
}

function generateAttributeList (snapshot) {
	var list_items = snapshot.child('specification_of_attributes');
	var attr_list = document.getElementById('attr_list');
	list_items.forEach (function (list_item){
		// create needed items
		var row        = document.createElement('TR');
		var attr_name  = document.createElement('TD');
		var attr_value = document.createElement('TD');
		var attr_spec  = document.createElement('TD');

		// set classes
		attr_name.className  = 'stext';
		attr_value.className = 'stext';
		attr_spec.className  = 'ltext';

		// set text
		attr_name.innerHTML  = list_item.key();
		attr_value.innerHTML = (list_item.val())['0'];
		attr_spec.innerHTML  = '<p>' + (list_item.val())['1'] + '</p>';

		// add to list row
		row.appendChild(attr_name);
		row.appendChild(attr_value);
		row.appendChild(attr_spec);

		// add row to list
		attr_list.appendChild(row);
	});
}

function generateExample (snapshot) {
	var example = snapshot.child('example');
    var text = '';
    
    //combine usage text 
    example.forEach (function (line){
        text = text + line.val() + "\n";
    });

    var container = document.getElementById('example_text')

    if (container){
        container.innerHTML = '<pre>' + text + '<pre>';
    }else{
        alert("RENDER ERROR: can not write \"Example\"");
    }
}

function generateBrowserSupportList (snapshot) {
	var browser_support = snapshot.child('browser_support');
	var row = document.createElement('TR');
	var name = document.createElement('TD');
	
	//alert('Hi');
	name.innerHTML = '&lt;' + tag_name + '&gt;'; // tag_name is a global variable
	name.className = 'stext';
	row.appendChild(name);

	//alert('Hi');
	browser_support.forEach (function (sup_or_not){
		var cell = document.createElement('TD');
		cell.innerHTML = sup_or_not.val();
		cell.className = 'stext';
		row.appendChild(cell);
	});

	var browser_support_list = document.getElementById('browser_sup_list');
	browser_support_list.appendChild(row);
}

function generateDefaultCss (snapshot) {
	var importedDataItems = snapshot.child('default_css');
    var text = '';
    
    //combine usage text 
    importedDataItems.forEach (function (line){
        text = text + line.val() + "\n";
    });

    var container = document.getElementById('default_css_text')

    if (container){
        container.innerHTML = '<pre>' + text + '<pre>';
    }else{
        alert("RENDER ERROR: can not write \"Default CSS\"");
    }
}

var tag_name = parseValue('tag_name');
dataRef.child('tag_info/' + tag_name).on('value', function (snapshot) {
	generateTitleAndNavigationLink(snapshot);
	generateDefinition(snapshot);
	generateUsage(snapshot);
	generateAttributeList(snapshot);
	generateExample(snapshot);
	generateBrowserSupportList(snapshot);
	generateDefaultCss(snapshot);
});

</script>

</body>
</html>
 




